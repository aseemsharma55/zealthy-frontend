{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Aseem/react-typescript-zealthy/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/Aseem/react-typescript-zealthy/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Aseem/react-typescript-zealthy/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Aseem/react-typescript-zealthy/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";;var AdminPanel=function AdminPanel(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tickets=_useState2[0],setTickets=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];useEffect(function(){var fetchTickets=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('http://127.0.0.1:8000/zealthy/fetch_users');case 3:response=_context.sent;console.log(response.data.data);setTickets(response.data.data);setIsLoading(false);// Set loading to false once data is fetched\n_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.error('Error fetching tickets:',_context.t0);setIsLoading(false);// Also set loading to false in case of error\ncase 13:case\"end\":return _context.stop();}},_callee,null,[[0,9]]);}));return function fetchTickets(){return _ref.apply(this,arguments);};}();fetchTickets();},[]);var updateTicketStatus=function updateTicketStatus(index,status){var updatedTickets=_toConsumableArray(tickets);updatedTickets[index].status=status;setTickets(updatedTickets);};var handleReplyChange=function handleReplyChange(index,reply){var updatedTickets=_toConsumableArray(tickets);updatedTickets[index].reply=reply;setTickets(updatedTickets);};var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(index,row){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;console.log(row);_context2.next=4;return axios.post('http://127.0.0.1:8000/zealthy/update',{'email':row.email,'status':row.status});case 4:response=_context2.sent;console.log(response);if(response.status===200){// Handle success - maybe clear the form or show a success message\nalert(\"Status Updated successfully!\");console.log(\"Status Updated successfully!\",response.data);}else{// Handle any non-200 HTTP status codes as you see fit\nconsole.error(\"Error submitting ticket:\",response.data);}_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);// Handle errors, e.g., network error or invalid JSON response\nconsole.error(\"API call failed:\",_context2.t0);case 12:// Logic to submit the reply and the updated status\nconsole.log(\"Would normally send email here with body: \".concat(tickets[index].reply));// Update your backend with the new status and the reply, if necessary\ncase 13:case\"end\":return _context2.stop();}},_callee2,null,[[0,9]]);}));return function handleSubmit(_x,_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"container mt-4\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Admin Panel\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Reply\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:tickets.map(function(ticket,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:ticket.name}),/*#__PURE__*/_jsx(\"td\",{children:ticket.email}),/*#__PURE__*/_jsx(\"td\",{children:ticket.desc}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{value:ticket.status,onChange:function onChange(e){return updateTicketStatus(index,e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"new\",children:\"New\"}),/*#__PURE__*/_jsx(\"option\",{value:\"in progress\",children:\"In Progress\"}),/*#__PURE__*/_jsx(\"option\",{value:\"resolved\",children:\"Resolved\"})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"textarea\",{onChange:function onChange(e){return handleReplyChange(index,e.target.value);}})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleSubmit(index,ticket);},children:\"Submit\"})})]},index);})})]})]});};export default AdminPanel;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","AdminPanel","_useState","_useState2","_slicedToArray","tickets","setTickets","_useState3","_useState4","isLoading","setIsLoading","fetchTickets","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","sent","console","log","data","t0","error","stop","apply","arguments","updateTicketStatus","index","status","updatedTickets","_toConsumableArray","handleReplyChange","reply","handleSubmit","_ref2","_callee2","row","_callee2$","_context2","post","email","alert","concat","_x","_x2","className","children","scope","map","ticket","name","desc","value","onChange","e","target","onClick"],"sources":["C:/Users/Aseem/react-typescript-zealthy/src/components/AdminPanel.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\ninterface UserTicket {\r\n  name: string;\r\n  email: string;\r\n  desc: string;\r\n  status: string;\r\n  reply?: string;\r\n};\r\n\r\nconst AdminPanel: React.FC = () => {\r\n  const [tickets, setTickets] = useState<UserTicket[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchTickets = async () => {\r\n        try {\r\n            const response = await axios.get('http://127.0.0.1:8000/zealthy/fetch_users');\r\n            console.log(response.data.data);\r\n            setTickets(response.data.data);\r\n            setIsLoading(false);  // Set loading to false once data is fetched\r\n        } catch (err) {\r\n            console.error('Error fetching tickets:', err);\r\n            setIsLoading(false);  // Also set loading to false in case of error\r\n        }\r\n    };\r\n\r\n    fetchTickets();\r\n  }, []);\r\n\r\n  const updateTicketStatus = (index: number, status: string) => {\r\n    const updatedTickets = [...tickets];\r\n    updatedTickets[index].status = status;\r\n    setTickets(updatedTickets);\r\n  };\r\n\r\n  const handleReplyChange = (index: number, reply: string) => {\r\n    const updatedTickets = [...tickets];\r\n    updatedTickets[index].reply = reply;\r\n    setTickets(updatedTickets);\r\n  };\r\n\r\n  const handleSubmit = async (index:number,row: UserTicket) => {\r\n    try {\r\n      console.log(row)\r\n      const response = await axios.post('http://127.0.0.1:8000/zealthy/update', {'email':row.email,'status':row.status});\r\n      console.log(response)\r\n      \r\n      if (response.status === 200) {\r\n          // Handle success - maybe clear the form or show a success message\r\n          alert(\"Status Updated successfully!\")\r\n          console.log(\"Status Updated successfully!\", response.data);\r\n      } else {\r\n          // Handle any non-200 HTTP status codes as you see fit\r\n          console.error(\"Error submitting ticket:\", response.data);\r\n      }\r\n  } catch (error) {\r\n      // Handle errors, e.g., network error or invalid JSON response\r\n      console.error(\"API call failed:\", error);\r\n  }\r\n    // Logic to submit the reply and the updated status\r\n    console.log(`Would normally send email here with body: ${tickets[index].reply}`);\r\n    // Update your backend with the new status and the reply, if necessary\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mt-4\">\r\n      <h2>Admin Panel</h2>\r\n      \r\n      <table className=\"table\">\r\n        <thead>\r\n          <tr>\r\n            <th scope=\"col\">Name</th>\r\n            <th scope=\"col\">Email</th>\r\n            <th scope=\"col\">Description</th>\r\n            <th scope=\"col\">Status</th>\r\n            <th scope=\"col\">Reply</th>\r\n            <th scope=\"col\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {tickets.map((ticket, index) => (\r\n            <tr key={index}>\r\n              <td>{ticket.name}</td>\r\n              <td>{ticket.email}</td>\r\n              <td>{ticket.desc}</td>\r\n              <td>\r\n                <select value={ticket.status} onChange={(e) => updateTicketStatus(index, e.target.value)}>\r\n                  <option value=\"new\">New</option>\r\n                  <option value=\"in progress\">In Progress</option>\r\n                  <option value=\"resolved\">Resolved</option>\r\n                </select>\r\n              </td>\r\n              <td>\r\n                <textarea onChange={(e) => handleReplyChange(index, e.target.value)} />\r\n              </td>\r\n              <td>\r\n                <button onClick={() => handleSubmit(index,ticket)}>Submit</button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminPanel;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}